<!DOCTYPE html>
<html lang="en">

<head>
  <xaiArtifact artifact_id="432c527f-9a2a-416d-89d6-4d14ef9e9015"
    artifact_version_id="7558c78f-4c0b-48f0-9b9a-06b49952c296" title="index.html" contentType="text/html">
    <!DOCTYPE html>
    <html lang="en">

    <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Launching App...</title>
      <style>
        body {
          background-color: #0d0d0d;
          color: #00ffe7;
          font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
          padding: 0;
          margin: 0;
          font-size: 13px;
          font-weight: 400;
          overflow-x: hidden;
        }

        .terminal {
          white-space: pre-wrap;
          /* wrap long lines on small screens */
          height: 100dvh;
          /* better mobile support than 100vh */
          overflow-y: auto;
          line-height: 1.4;
          padding: 12px;
          font-weight: normal;
          letter-spacing: 0.2px;
          box-sizing: border-box;
        }

        /* Scroll improvement on mobile */
        .terminal::-webkit-scrollbar {
          width: 6px;
        }

        .terminal::-webkit-scrollbar-thumb {
          background-color: #444;
          border-radius: 3px;
        }

        /* Colors for types of messages */
        .timestamp {
          color: #aaaaaa;
        }

        .task {
          color: #ff4fd8;
        }

        .success {
          color: #00ff9c;
        }

        .info {
          color: #00ffe7;
        }

        .warn {
          color: #ffcc00;
        }

        .error {
          color: #ff5c57;
        }

        a {
          color: #ff4fd8;
          text-decoration: none;
          word-break: break-all;
          /* prevent horizontal overflow */
        }

        a:hover {
          text-decoration: underline;
        }
      </style>

    </head>

<body>
  <div class="terminal" id="terminal">SYSTEM BOOT INITIALIZED...\n</div>

  <script>
    const terminal = document.getElementById('terminal');

    const apps = {
      '1': 'https://mznews.onrender.com',
      '2': 'https://thehadithdaily.onrender.com',
      '3': 'https://bhulabhatka.onrender.com'
    };

    function log(text) {
      terminal.innerText += text + '\n';
      terminal.scrollTop = terminal.scrollHeight; // Auto-scroll to bottom
    }

    // Simulate a progress bar animation
    async function showProgressBar(fileName, fileSize, speed) {
      const totalBars = 40; // Total length of the progress bar
      let progress = 0;
      const interval = 100; // Update every 100ms
      const steps = Math.floor((fileSize / speed) * 1000 / interval); // Simulate download time
      const increment = totalBars / steps;

      log(`Downloading ${fileName} (${fileSize} kB)`);
      let barLine = `   ${progress.toFixed(1)}% ‚îÅ${'‚îÅ'.repeat(Math.floor(progress / (100 / totalBars)))}${'‚ï∫'.repeat(totalBars - Math.floor(progress / (100 / totalBars)))} ${fileSize}/${fileSize} kB ${speed} MB/s eta 0:00:00`;
      terminal.innerText += barLine + '\n';

      while (progress < 100) {
        await new Promise(resolve => setTimeout(resolve, interval));
        progress = Math.min(progress + increment * 100 / totalBars, 100);
        terminal.innerText = terminal.innerText.replace(
          barLine,
          `   ${progress.toFixed(1)}% ‚îÅ${'‚îÅ'.repeat(Math.floor(progress / (100 / totalBars)))}${'‚ï∫'.repeat(totalBars - Math.floor(progress / (100 / totalBars)))} ${fileSize}/${fileSize} kB ${speed} MB/s eta 0:00:00`
        );
        barLine = `   ${progress.toFixed(1)}% ‚îÅ${'‚îÅ'.repeat(Math.floor(progress / (100 / totalBars)))}${'‚ï∫'.repeat(totalBars - Math.floor(progress / (100 / totalBars)))} ${fileSize}/${fileSize} kB ${speed} MB/s eta 0:00:00`;
        terminal.scrollTop = terminal.scrollHeight;
      }
    }

    function getAppId() {
      const params = new URLSearchParams(window.location.search);
      return params.get('app');
    }

    async function wakeAllApps() {
      const promises = Object.entries(apps).map(async ([id, url]) => {
        try {
          await fetch(url, { method: 'GET', mode: 'no-cors' });
        } catch {
        }
      });
      return Promise.all(promises);
    }

    async function redirectToApp(appId) {
      const url = apps[appId];

      if (!url) {
        log("‚ùå ERROR: INVALID APP ID DETECTED");
        showInstructions();
        return;
      }

      try {
        await fetch(url, { method: 'GET', mode: 'no-cors' });
        log("‚úÖ APP VERIFICATION COMPLETE -- READY FOR LAUNCH");
        log(`REDIRECTING TO TARGET: ${url}`);
        window.location.href = url; // Redirect immediately
      } catch (e) {
        log("‚ö†Ô∏è CONNECTION FAILURE: UNABLE TO REACH TARGET APP");
      }
    }

    function showInstructions() {
      terminal.innerText = ''; // Clear terminal for main page
      log("\n=== üìò SYSTEM INSTRUCTIONS ===");
      log("LAUNCH PROTOCOL: APPEND ?app=1, ?app=2, OR ?app=3 TO URL");
      log("EXAMPLE: https://yourdomain.com?app=1");
    }

    // Simulated Dependency Installation with Progress Bars
    async function simulateDependencyInstallation() {
      function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }

      async function simulateDependencyInstallation() {
        const logWithDelay = async (message) => {
          log(message);
          await sleep(600); // 1 second delay
        };

        await logWithDelay("CHECKING SYSTEM REQUIREMENTS... DONE");
        await logWithDelay("INITIALIZING DEPENDENCY INSTALLATION...");
        await logWithDelay("\n=== üì¶ DEPENDENCY REPORT ===");

        await logWithDelay("Collecting astunparse>=1.6.0 (from app-launcher>=1.0.0)");
        await logWithDelay("  Using cached opt_einsum-3.4.0-py3-none-any.whl.metadata (6.3 kB)");
        await logWithDelay("Collecting protobuf>=3.20.3,<6.0.0dev (from app-launcher>=1.0.0)");
        await logWithDelay("  Using cached protobuf-5.29.4-cp310-abi3-win_amd64.whl.metadata (592 bytes)");

        await showProgressBar("render-client-2.0.0-py3-none-any.whl", 25, 1.8);

        await logWithDelay("Collecting setuptools (from app-launcher>=1.0.0)");
        await logWithDelay("  Using cached setuptools-80.8.0-py3-none-any.whl.metadata (6.6 kB)");

        await showProgressBar("render-client-2.0.0-py3-none-any.whl", 50, 1.8);
        await showProgressBar("app-launcher-1.0.0-py3-none-any.whl", 108, 2.5);
        await showProgressBar("render-client-2.0.0-py3-none-any.whl", 125, 1.8);
        await showProgressBar("render-client-2.0.0-py3-none-any.whl", 205, 1.8);

        await logWithDelay("Collecting astunparse>=1.6.0 (from app-launcher>=1.0.0)");
        await logWithDelay("  Using cached astunparse-1.6.3-py2.py3-none-any.whl.metadata (4.4 kB)");
        await logWithDelay("Collecting flatbuffers>=24.3.25 (from app-launcher>=1.0.0)");
        await logWithDelay("  Using cached flatbuffers-25.2.10-py2.py3-none-any.whl.metadata (875 bytes)");
        await logWithDelay("Collecting gast>=0.2.1 (from app-launcher>=1.0.0)");
        await logWithDelay("  Using cached opt_einsum-3.4.0-py3-none-any.whl.metadata (6.3 kB)");
        await logWithDelay("Collecting protobuf>=3.20.3,<6.0.0dev (from app-launcher>=1.0.0)");
        await showProgressBar("render-client-2.0.0-py3-none-any.whl", 25, 1.8);
        await showProgressBar("render-client-2.0.0-py3-none-any.whl", 25, 1.8);
        await logWithDelay("  Using cached protobuf-5.29.4-cp310-abi3-win_amd64.whl.metadata (592 bytes)");
        await logWithDelay("Collecting setuptools (from app-launcher>=1.0.0)");
        await logWithDelay("  Using cached setuptools-80.8.0-py3-none-any.whl.metadata (6.6 kB)");

        await logWithDelay("\nVERIFYING MODULE INTEGRITY... DONE");
        await logWithDelay("DEPENDENCIES: astunparse, flatbuffers, gast, google-pasta, libclang, opt-einsum, protobuf, setuptools, typing-extensions, wrapt, grpcio, numpy -- STATUS: INSTALLED");
        await logWithDelay("SYSTEM: render-deployment-agent -- STATUS: READY");
      }

    }

    // Boot Process
    const appId = getAppId();

    // Start wake-up and redirect immediately on page load
    if (appId) {
      wakeAllApps(); // Start waking apps
      redirectToApp(appId); // Attempt redirect immediately
      simulateDependencyInstallation(); // Run animation in background
    } else {
      showInstructions();
    }
  </script>
</body>

</html>